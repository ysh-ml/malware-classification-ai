import pefile

from sec_e import get_sec_e


#basic idea of parser

def parse_PE(path):
    
    pe = pefile.PE(path,fast_load=False)
    
    Machine = pe.FILE_HEADER.Machine
    SizeOfOptionalHeader = pe.FILE_HEADER.SizeOfOptionalHeader
    Characteristics = pe.FILE_HEADER.Characteristics
    MajorSubsystemVersion = pe.OPTIONAL_HEADER.MajorSubsystemVersion
    Subsystem = pe.OPTIONAL_HEADER.Subsystem
    DllCharacteristics = pe.OPTIONAL_HEADER.DllCharacteristics
    ImageBase = pe.OPTIONAL_HEADER.ImageBase
    CheckSum = pe.OPTIONAL_HEADER.CheckSum
    SizeOfStackCommit = pe.OPTIONAL_HEADER.SizeOfStackCommit
    SizeOfStackReserve = pe.OPTIONAL_HEADER.SizeOfStackReserve
    
    SectionsMeanEntropy, SectionsMaxEntropy= get_sec_e(pe)

    return [Machine,
 SizeOfOptionalHeader,
 Characteristics,
 MajorSubsystemVersion,
 Subsystem,
 DllCharacteristics,
 SectionsMeanEntropy,
 SectionsMaxEntropy,
 SizeOfStackCommit,
 SizeOfStackReserve,
 ImageBase,
 CheckSum]